
@using Microsoft.Web.Mvc;

@section page_title{
    Diagnosis Item: Overview
}
@{
    Html.RenderPartial("_SubNavigation");
    Html.RenderPartial("_ServicesAdministrationSideBar");
}
<script type="text/javascript">
    Ext.onReady(function () {

        var administrationBtnId = window.res.header.navigation.administration;
        var administrationBtn = Ext.getCmp(administrationBtnId);
        administrationBtn.toggle(true);

        var diagnosisSideBarBtnId = window.res.content.maincontent.sidebar.diagnosis;
        var diagnosisBtn = Ext.getCmp(diagnosisSideBarBtnId);

        diagnosisBtn.toggle(true);


        var diagnosisAdministrationBtnId = window.res.header.subnavigation.buttonTabs.diagnosis;
        var diagnosisAdministrationBtn = Ext.getCmp(diagnosisAdministrationBtnId);
        diagnosisAdministrationBtn.toggle(true);
        diagnosisAdministrationBtn.setIcon('@(Url.RouteUrl<Web.Controllers.AssetsController>(it => it.Shared("/img/Administration/SubMenu/ProductSelected.png"), Web.Bootstrap.Routes.AssetRoutesRegistrar.SHARED))');
    });
</script>
<script type="text/javascript">
    Ext.onReady(function () {
        window.feature = {};


        window.feature.modal = Ext.define('Ext.feature.region.Modal', {
            extend: 'Ext.window.Window',
            modal: true,
            ui: 'snapshot-popup-window',
            height: 200,
            width: 390,
            layout: {
                align: 'stretch',
                padding: 10,
                type: 'vbox'
            },

            initComponent: function () {
                var me = this;

                Ext.applyIf(me, {
                    items: [{
                        xtype: 'textfield',
                        name: 'Name',
                        fieldLabel: 'Name',
                        anchor: '100%',
                        itemId: window.feature.formProductGroupNameId
                    }, {
                        xtype: 'textfield',
                        name: 'CodeDS',
                        fieldLabel: 'CodeDS',
                        anchor: '100%',
                        itemId: window.feature.formProductGroupReferenceCodeId,
                        regex: /^[A-Za-z]{3}$/,
                        regexText: 'You need to provide 3 letters!'
                    }, {
                        xtype: 'textfield',
                        name: 'Display',
                        fieldLabel: 'Display',
                        anchor: '100%',
                        itemId: window.feature.formProductGroupDescriptionId
                    }]
                });

                me.callParent(arguments);
            }
        });

        window.feature.container = Ext.create('Ext.container.Container', {
            margin:'45 50 20 20',
            padding:'20 0 0 20',
            autoScroll: true,
            id: 'TopContainer',
            layout: {
                align: 'stretch',
                type: 'vbox'
            },
            items: [{
                xtype: 'container',
                layout: {
                    type: 'hbox'
                },
                height: 60,
                items:[{
                    xtype: 'container',
                    flex: 1,
                    height: 70,
                    layout: {
                        type: 'column'
                    },
                    items: [{
                        xtype: 'container',
                        height: 30,
                        width: 30,
                        html: '&nbsp;'
                    }, {
                        xtype: 'image',
                        src: '@(Url.RouteUrl<Web.Controllers.AssetsController>(it => it.Shared("/img/Administration/SubMenu/ProductSelected.png"), Web.Bootstrap.Routes.AssetRoutesRegistrar.SHARED))',
                        margin: '0 10 10 10'
                    }, {
                        xtype: 'label',
                        cls: 'x-title-label',
                        text: 'Diagnosis'
                    }, {
                        xtype: 'button',
                        margin: '0 0 0 20',
                        ui: 'snapshot-add-btn',
                        cls: 'x-add-button-gradient',
                        //disabled: @(ViewBag.HasNoRightsToAdd),
                        text: 'Add New Diagnosis',
                        handler: function(){
                            var winAdd = new window.feature.modal({
                                title: 'Add New Product Group',
                                buttons: [
                                    { text: 'Cancel',
                                        margin: '10 10 20 0',
                                        ui: 'snapshot-cancel-btn',
                                        cls: 'x-add-button-gradient',
                                        handler: function () { winAdd.close(); winAdd.destroy(); } 
                                    },
                                    { text: 'Save',
                                        margin: '0 20 20 10',
                                        ui: 'snapshot-add-btn',
                                        cls: 'x-add-button-gradient',
                                        handler: function () {
                                        }
                                    }
                                ]
                            });
                            winAdd.show();
                        }
                    }]
                },{
                    xtype: 'container',
                    flex: 1,
                    layout: {
                        type: 'hbox',
                        pack:'end'
                    },
                    height: 80,
                    items: [{
                        xtype: 'textfield',
                        itemId: window.feature.searchProductGroupName,
                        width: 200,
                        frame: true,
                        cls: 'text-field-rounded',
                        emptyText: 'Diagnosis Search',
                        enableKeyEvents: true,
                        listeners: {
                            'keyup': {
                                fn: function(key) {

                                }
                            }
                        }
                    }]

                }]
            },{
                xtype: 'gridpanel',
                cls: 'white-border',
                itemId: window.feature.gridProductGroupId,
                store: window.feature.diagnosisStore,
                loadMask: true,
                disableSelection: true,
                flex:3,
                autoScroll:true,
                columns: [{
                    header: "Product Group",
                    dataIndex: 'Name',
                    flex: 1,
                    menuDisabled: true,
                    sortable: true
                },{
                    text: "Number of Products",
                    dataIndex: 'ProductsNo',
                    flex: 1,
                    menuDisabled: true,
                    sortable: false
                },{
                    xtype: 'actioncolumn',
			        text: 'Actions',
                    flex: 1,
                    menuDisabled: true,
                    items: [{
                        icon: '@(Url.RouteUrl<Web.Controllers.AssetsController>(it => it.Shared("/img/edit.png"), Web.Bootstrap.Routes.AssetRoutesRegistrar.SHARED))', 
                        action: 'Edit'
                    },{
                        icon: '@(Url.RouteUrl<Web.Controllers.AssetsController>(it => it.Shared("/img/delete.png"), Web.Bootstrap.Routes.AssetRoutesRegistrar.SHARED))',     
                        action: 'Delete'
                    }]
                }]
            }]
        });

        var contentRes = window.res.content;
        var mainContent = Ext.getCmp(contentRes.maincontent.id);

        mainContent.add(window.feature.container);
    });

</script>
